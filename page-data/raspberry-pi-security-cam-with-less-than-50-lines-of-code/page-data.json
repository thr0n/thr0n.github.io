{"componentChunkName":"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx","path":"/raspberry-pi-security-cam-with-less-than-50-lines-of-code","result":{"data":{"post":{"__typename":"MdxPost","slug":"/raspberry-pi-security-cam-with-less-than-50-lines-of-code","title":"Raspberry Pi security cam - With less than 50 lines of code","date":"21.08.2021","tags":[{"name":"Raspberry Pi","slug":"raspberry-pi"},{"name":"Python","slug":"python"}],"description":"...","canonicalUrl":null,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Raspberry Pi security cam - With less than 50 lines of code\",\n  \"date\": \"2021-08-21T00:00:00.000Z\",\n  \"description\": \"...\",\n  \"tags\": [\"Raspberry Pi\", \"Python\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"A few days ago, my neighbours discovered that someone had broken into their cellar. That was unpleasant news, both for them and for me. There are no treasures stored in my cellar, but the situation led me to the following question: What can I do if someone invades my home while I am away? \"), mdx(\"p\", null, \"From the perspective of a software developer, the answer is of course obvious. I just need a surveillance camera pointed at the front door that takes several photos when someone opens it. Of course, this does not prevent someone from coming in, but at least the person is photographed in the process \\uD83D\\uDCF8 And I know from German television that these can be quite helpful in tracking down the culprits \\uD83D\\uDE09\"), mdx(\"h3\", null, \"Hardware\"), mdx(\"p\", null, \"In fact, you don't need much at all for a simple implementation of this idea. I use my old \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Raspberry Pi Model B+\"), \" as a basis, which still contains an old \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"SD card\"), \" for the operating system. I also got the Pi \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"camera module\"), \" as a Christmas present years ago. Unfortunately, I seem to have lost my USB \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Wifi adapter\"), \". So I bought a new one, along with a simple \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"motion detector\"), \".\"), mdx(\"p\", null, \"So with this hardware I can now take photos when a movement is detected in the flat. But what if the SD card runs out of space or a possible burglar takes it? \"), mdx(\"h3\", null, \"Cloud storage\"), mdx(\"p\", null, \"This problem can be solved using a cloud storage. It's enough to just store the images on the Pi temporarily and then upload them to the cloud. This also has the advantage that I can check from anywhere and at any time whether anything has happened in the flat. Since I have had a Dropbox account for years, I use it for backing up the photos. With this account, it is very easy to create an app on the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.dropbox.com/developers\"\n  }, \"developer page\"), \". What you need at the end is an access token with which the app can access Dropbox.\"), mdx(\"h3\", null, \"Software\"), mdx(\"p\", null, \"To my surprise, I only needed a some libraries and a few lines of Python code for a simple camera functionality.\"), mdx(\"p\", null, \"Most of the work is done in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"pressed()\"), \" method. First, five photos are created and saved under a temporary name on the SD card. The Dropbox app is then accessed using the access token. The photos can then be uploaded with the db object. The rest of the code is initialisation and deleting temporary files that are still in the directory after a possible crash. The number of photos to be taken or the waiting time after the sensor has triggered can of course be individually adjusted.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python\"\n  }, \"#!/usr/bin/python3\\nfrom dotenv import dotenv_values\\nfrom gpiozero import Button, LED\\nfrom time import sleep\\nimport datetime, dropbox, picamera, os\\n\\nconfig = dotenv_values(\\\".env\\\")\\ndb_ac = config[\\\"DB_ACCESS_TOKEN\\\"]\\nnum_pics = 5\\nbutton = Button(7, pull_up=False)\\n\\ndef pressed():\\n    camera = picamera.PiCamera()\\n    camera.vflip = True\\n    camera.hflip = True\\n    camera.resolution=(2592, 1944)\\n    for x in range(num_pics):\\n        localname = 'tmp' + str(x) + '.jpg'\\n        camera.capture(localname)\\n    camera.close()\\n\\n    db = dropbox.Dropbox(db_ac)\\n    for x in range(num_pics):\\n        localname = 'tmp' + str(x) + '.jpg'\\n        f = open(localname, 'rb')\\n        timestamp = datetime.datetime.now().isoformat()\\n        upname = '/rapi-' + timestamp + '.jpg'\\n        db.files_upload(f.read(), upname)\\n        f.close()\\n        db.close()\\n        os.remove(localname)\\n\\nfor x in range(num_pics):\\n    if os.path.exists(\\\"tmp\\\" + str(x) + \\\".jpg\\\"):\\n        os.remove(\\\"tmp\\\" + str(x) + \\\".jpg\\\")\\n\\nwhile True:\\n    button.wait_for_press()\\n    pressed()\\n    sleep(5)\\n\")), mdx(\"h3\", null, \"Conclusion\"), mdx(\"p\", null, \"In the end, I could not find any intruders in the pictures. The only thing that stood out was my cat Frieda, who was obviously trying to catch a fly. What luck! I very much hope that it stays that way.\"), mdx(\"p\", null, mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"https://i.makeagif.com/media/8-20-2021/OU5KfW.gif\",\n    \"alt\": \"frieda-hunting-a-fly\"\n  })));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"A few days ago, my neighbours discovered that someone had broken into their cellar. That was unpleasant news, both for them and for meâ€¦","timeToRead":2,"banner":null}},"pageContext":{"slug":"/raspberry-pi-security-cam-with-less-than-50-lines-of-code","formatString":"DD.MM.YYYY"}},"staticQueryHashes":["3090400250","3090400250","318001574"]}